<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catch the Square - 2 Player Edition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --bg-color: #111;
      --text-color: white;
      --square-color: #00ffcc;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      text-align: center;
      overflow-x: hidden;
    }
    h1 {
      margin-top: 10px;
      font-size: 1.8rem;
    }
    #game-area {
      position: relative;
      width: 100%;
      height: 60vh;
      overflow: hidden;
      border: 2px solid var(--text-color);
      margin: 15px auto;
      background: var(--bg-color);
      touch-action: manipulation;
    }
    .square {
      position: absolute;
      width: 12vw;
      max-width: 60px;
      height: 12vw;
      max-height: 60px;
      background-color: var(--square-color);
      cursor: pointer;
      border-radius: 8px;
      animation: pop 0.3s ease;
    }
    @keyframes pop {
      0% { transform: scale(0.7); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    #controls {
      margin-top: 10px;
    }
    .score-box {
      font-size: 18px;
      margin: 5px;
    }
    button, select {
      padding: 8px 12px;
      font-size: 15px;
      margin: 6px;
      border-radius: 6px;
      border: none;
    }
    #start-btn { background-color: #00ffcc; color: #000; }
    #pause-btn { background-color: #ffcc00; color: #000; }
    #start-btn:hover { background-color: #00ddb3; }
    #pause-btn:hover { background-color: #e6b800; }
    #theme-select { font-size: 14px; }
    #game-over { font-size: 1.5rem; color: red; margin-top: 15px; display: none; }
    @media (max-width: 600px) {
      .square { width: 14vw; height: 14vw; }
    }
  </style>
</head>
<body>

<h1>ðŸŽ® Catch the Square - 2 Player</h1>

<div id="controls">
  <div class="score-box" id="score">Player 1 Score: 0</div>
  <div class="score-box" id="score2">Player 2 Score: 0</div>
  <div class="score-box" id="timer">Time: 30</div>
  <select id="theme-select">
    <option value="dark">Dark</option>
    <option value="light">Light</option>
    <option value="retro">Retro</option>
  </select>
  <button id="start-btn">Start Game</button>
  <button id="pause-btn" disabled>Pause</button>
  <button id="music-btn">ðŸ”Š Music</button>
</div>

<div id="game-area"></div>
<div id="game-over"></div>

<audio id="click-sound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_8d0e3c39d0.mp3?filename=click-124467.mp3"></audio>
<audio id="miss-sound" src="https://cdn.pixabay.com/download/audio/2022/03/26/audio_2938a8b090.mp3?filename=error-126627.mp3"></audio>
<audio id="bg-music" loop src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_276be2e45f.mp3?filename=happy-adventure-11295.mp3"></audio>

<script>
  const gameArea = document.getElementById('game-area');
  const scoreDisplay = document.getElementById('score');
  const score2Display = document.getElementById('score2');
  const timerDisplay = document.getElementById('timer');
  const startBtn = document.getElementById('start-btn');
  const pauseBtn = document.getElementById('pause-btn');
  const musicBtn = document.getElementById('music-btn');
  const themeSelect = document.getElementById('theme-select');
  const gameOverText = document.getElementById('game-over');
  const clickSound = document.getElementById('click-sound');
  const missSound = document.getElementById('miss-sound');
  const bgMusic = document.getElementById('bg-music');

  let playerTurn = 1;
  let score1 = 0, score2 = 0, timer = 30;
  let disappearTime = 1500;
  let running = false, paused = false;
  let interval, square, musicPlaying = false;

  function setTheme(theme) {
    const root = document.documentElement;
    if (theme === 'dark') {
      root.style.setProperty('--bg-color', '#111');
      root.style.setProperty('--text-color', 'white');
      root.style.setProperty('--square-color', '#00ffcc');
    } else if (theme === 'light') {
      root.style.setProperty('--bg-color', '#fff');
      root.style.setProperty('--text-color', '#000');
      root.style.setProperty('--square-color', '#0077cc');
    } else if (theme === 'retro') {
      root.style.setProperty('--bg-color', '#222');
      root.style.setProperty('--text-color', '#f5de8e');
      root.style.setProperty('--square-color', '#f54291');
    }
  }

  function createSquare() {
    if (!running || paused) return;
    if (square) square.remove();

    square = document.createElement('div');
    square.className = 'square';
    const x = Math.random() * (gameArea.clientWidth - 60);
    const y = Math.random() * (gameArea.clientHeight - 60);
    square.style.left = `${x}px`;
    square.style.top = `${y}px`;

    square.addEventListener('click', () => {
      clickSound.play();
      if (playerTurn === 1) score1++;
      else score2++;
      updateScores();
      square.remove();
      createSquare();
    });

    gameArea.appendChild(square);

    setTimeout(() => {
      if (!paused && gameArea.contains(square)) {
        missSound.play();
        square.remove();
        createSquare();
      }
    }, disappearTime);
  }

  function updateScores() {
    scoreDisplay.textContent = `Player 1 Score: ${score1}`;
    score2Display.textContent = `Player 2 Score: ${score2}`;
  }

  function startGame() {
    playerTurn = 1;
    score1 = 0;
    score2 = 0;
    timer = 30;
    running = true;
    paused = false;
    disappearTime = 1500;
    updateScores();
    gameOverText.style.display = 'none';
    startBtn.disabled = true;
    pauseBtn.disabled = false;
    timerDisplay.textContent = `Time: ${timer}`;
    createSquare();
    if (!musicPlaying) toggleMusic();
    interval = setInterval(gameTick, 1000);
  }

  function gameTick() {
    if (!paused) {
      timer--;
      timerDisplay.textContent = `Time: ${timer}`;
      if (timer === 0) {
        if (playerTurn === 1) {
          playerTurn = 2;
          timer = 30;
          disappearTime = 1500;
          createSquare();
        } else {
          endGame();
        }
      } else if (timer % 10 === 0 && disappearTime > 400) {
        disappearTime -= 200;
      }
    }
  }

  function endGame() {
    running = false;
    clearInterval(interval);
    if (square) square.remove();
    let winner = score1 > score2 ? "Player 1 Wins!" : score2 > score1 ? "Player 2 Wins!" : "It's a Tie!";
    gameOverText.textContent = `Game Over! ${winner}`;
    gameOverText.style.display = 'block';
    startBtn.disabled = false;
    pauseBtn.disabled = true;
  }

  function togglePause() {
    paused = !paused;
    pauseBtn.textContent = paused ? "Resume" : "Pause";
    if (!paused) createSquare();
  }

  function toggleMusic() {
    if (musicPlaying) {
      bgMusic.pause();
      musicBtn.textContent = 'ðŸ”‡ Music';
    } else {
      bgMusic.play();
      musicBtn.textContent = 'ðŸ”Š Music';
    }
    musicPlaying = !musicPlaying;
  }

  startBtn.onclick = startGame;
  pauseBtn.onclick = togglePause;
  musicBtn.onclick = toggleMusic;
  themeSelect.onchange = (e) => setTheme(e.target.value);

  setTheme('dark');
</script>
</body>
</html>
